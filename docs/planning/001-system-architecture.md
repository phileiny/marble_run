# 001 - 系統架構規劃

## 專案概述

彈珠軌道模擬器（Marble Run）- 一個網頁版的彈珠滾動遊戲

## 使用者流程

1. 進入網頁，看到軌道選擇畫面
2. 從三種經典軌道中選擇一種
3. 按下「開始模擬」
4. 觀看彈珠沿著軌道滾動
5. 彈珠落入回收盒，模擬結束
6. 可選擇「重新選擇」回到步驟 2

## 技術選型

| 項目 | 選擇 | 理由 |
|------|------|------|
| 語言 | TypeScript | 型別安全 |
| 建置工具 | Vite | 快速、簡單 |
| 繪圖 | HTML5 Canvas | 效能好 |
| 音效 | Web Audio API | 低延遲、程式化生成 |
| 部署 | GitHub Pages | 免費、易整合部落格 |

## 三種軌道設計

| 名稱 | 特色 |
|------|------|
| 經典斜坡 | S 型下坡 |
| 單環迴圈 | 一個 360° 環形 |
| 雙重迴圈 | 連續兩個環形 |

## 專案結構

```
marble_run/
├── src/
│   ├── core/           # 引擎、物理、狀態管理
│   ├── entities/       # 彈珠、軌道、回收盒
│   ├── tracks/         # 三種預設軌道
│   ├── rendering/      # Canvas 繪製、粒子特效
│   ├── audio/          # 音效管理
│   ├── ui/             # 選擇介面、控制按鈕
│   └── main.ts         # 程式進入點
├── public/
├── index.html
├── style.css
├── package.json
├── tsconfig.json
└── vite.config.ts
```

## 視覺效果

- 彈珠光澤（漸層 + 高光）
- 軌道金屬質感
- 運動模糊
- 粒子特效（落入回收盒時）
- 柔和漸層背景

## 音效設計

| 事件 | 音效 |
|------|------|
| 滾動中 | 持續滾動聲，音高隨速度變化 |
| 通過迴圈 | 加速「咻～」聲 |
| 落入回收盒 | 「叮！」碰撞聲 |
| 點擊按鈕 | 輕微點擊音效 |

## 遊戲狀態

```
SELECTING → SIMULATING → FINISHED
    ↑                        │
    └────────────────────────┘
```

## 待確認事項

- [x] 技術選型已確認
- [x] 三種軌道設計已確認
- [x] 音效需求已確認
