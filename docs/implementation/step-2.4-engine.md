# Step 2.4 - Engine 遊戲主迴圈

## 建立的檔案

### src/core/Engine.ts

## 架構

```
requestAnimationFrame
        │
        ▼
    計算 deltaTime
        │
        ▼
    累積時間 (accumulator)
        │
        ▼
  ┌─────────────────┐
  │ 固定步長更新     │ ← 物理更新 (1/60 秒)
  │ while >= 1/60s  │
  └─────────────────┘
        │
        ▼
    繪製畫面
```

## 特點

1. **固定時間步長**：物理更新以 60 FPS 固定步長執行，確保模擬穩定
2. **累積器模式**：處理不同裝置幀率差異
3. **螺旋死亡保護**：累積時間上限 0.2 秒

## 方法

| 方法 | 說明 |
|------|------|
| `onUpdate(callback)` | 設定物理更新回呼 |
| `onRender(callback)` | 設定繪製回呼 |
| `start()` | 開始遊戲迴圈 |
| `stop()` | 停止遊戲迴圈 |
