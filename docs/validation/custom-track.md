# 自訂軌道功能驗證

## 測試環境

- 瀏覽器：Chrome / Firefox / Safari
- 開發伺服器：`npm run dev`
- 生產建置：`npm run build`

## 測試案例

### TC-1：軌道選擇器顯示

**步驟：**
1. 啟動應用程式
2. 查看軌道選擇區域

**預期結果：**
- [x] 顯示四個軌道選項
- [x] 第四個為「自訂軌道」
- [x] 自訂選項使用虛線邊框區分

---

### TC-2：進入編輯模式

**步驟：**
1. 點擊「自訂軌道」選項

**預期結果：**
- [x] 選項變為選中狀態（實線藍框）
- [x] 軌道選擇器隱藏
- [x] Canvas 游標變為十字
- [x] 顯示提示「點擊畫布新增起點」
- [x] 按鈕區顯示「開始模擬」（停用）和「取消編輯」

---

### TC-3：新增控制點

**步驟：**
1. 進入編輯模式
2. 在畫布左上方點擊（新增起點）
3. 在畫布中間偏下方點擊（新增第二點）
4. 在畫布右下方點擊（新增終點）

**預期結果：**
- [x] 起點顯示綠色圓點，標示「起」
- [x] 終點顯示紅色圓點，標示「終」
- [x] 中間點顯示藍色圓點
- [x] 各點之間用藍色虛線連接
- [x] 有 2 個點後，「開始模擬」按鈕啟用

---

### TC-4：拖曳控制點

**步驟：**
1. 新增至少 2 個控制點
2. 將滑鼠移到控制點上（游標變為 grab）
3. 按住左鍵拖曳控制點到新位置
4. 放開滑鼠

**預期結果：**
- [x] 控制點跟隨滑鼠移動
- [x] 連接線即時更新
- [x] 拖曳時游標變為 grabbing

---

### TC-5：移除控制點

**步驟：**
1. 新增 3 個控制點
2. 按右鍵

**預期結果：**
- [x] 移除最後一個控制點
- [x] 終點標示轉移到倒數第二個點
- [x] 連接線即時更新

---

### TC-6：取消編輯

**步驟：**
1. 進入編輯模式
2. 新增數個控制點
3. 點擊「取消編輯」按鈕

**預期結果：**
- [x] 回到軌道選擇畫面
- [x] 編輯內容清除
- [x] 軌道選擇器重新顯示

---

### TC-7：開始模擬

**步驟：**
1. 進入編輯模式
2. 從左上角到右下角新增 4-5 個控制點（模擬下坡）
3. 點擊「開始模擬」

**預期結果：**
- [x] 彈珠從起點開始滾動
- [x] 軌道使用 Catmull-Rom 樣條呈現平滑曲線
- [x] 終點下方顯示收集盒
- [x] 滾動音效播放
- [x] 彈珠落入收集盒後播放成功音效

---

### TC-8：自訂軌道物理

**步驟：**
1. 建立一個有迴圈的軌道（先下後上再下）
2. 開始模擬

**預期結果：**
- [x] 彈珠能通過曲線
- [x] 曲率大時播放「咻」聲
- [x] 彈珠可能因動能不足而停止（觸發失敗）

---

### TC-9：建置驗證

**步驟：**
1. 執行 `npm run build`

**預期結果：**
- [x] TypeScript 編譯無錯誤
- [x] Vite 建置成功
- [x] dist 資料夾產生正確檔案

---

## 建置輸出

```
> npm run build

vite v5.4.21 building for production...
✓ 26 modules transformed.
dist/index.html                  0.73 kB │ gzip: 0.46 kB
dist/assets/index-vte1PahG.css   1.83 kB │ gzip: 0.76 kB
dist/assets/index-DZaymm92.js   30.75 kB │ gzip: 9.26 kB
✓ built in 115ms
```

## 已知限制

- 軌道不會自動儲存（重新整理後遺失）
- 最少需要 2 個控制點
- 無法刪除中間的控制點（只能刪除最後一個）

## 結論

自訂軌道功能通過所有測試案例，可正常運作。
